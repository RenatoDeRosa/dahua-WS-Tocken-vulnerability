# dahua-WS-Tocken-vulnerability
walkthrough using dahua WS-Token-vulnerability

i have searched the network to find a good exploit for dahua ip cam and found these information:
Creator @RDR

ip camera like dahua use the onvif (Open Network Video Interface Forum) protocol,
in ip camera like the IPC-HDBW2231E-S-S2 as talked in 
this article from nozomi network https://www.nozominetworks.com/blog/vulnerability-in-dahua-s-onvif-implementation-threatens-ip-camera-security/
in unprotected comunication HTTP we can sniff the network of the ip camera and search for html/xml protocol 
and then we're able to recognize a digest password create with a function like this one:

Digest = B64ENCODE( SHA1( B64DECODE( Nonce ) + Created + Password ) )

where the:
    Username – Is the username for a certified user                                                                                                             
    Nonce – A random, unique number generated by a client                                                                                                       
    Created – is the UtcTime when the request is made                                                                                                           
    Password – is the password for a certified user                                                                                                             

soo by crafting a custom request and replaing the digest password we are able to get response as we were sending http request with an admin account, 
soo we can create a new user, reboot the camera and soo on.

example of a http post request for creating a new user:

![immagine](https://user-images.githubusercontent.com/60145559/210282568-73d7eb81-3570-449c-85e5-3e4be79710a7.png)

in these day i will try the attack
